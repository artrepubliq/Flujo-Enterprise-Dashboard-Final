<div class="chat-windows" style="display: none;" #chat_box>
  <div class="scrollBlock">
    <div>
      <div #smallWindow class="flujoChat-box smallWindow" *ngFor="let selecteduseritem of selectedUsers,let i=index"
        (click)="activateSelectedWindow(i)" [ngClass]="{'hide_chat':selecteduseritem?.isChatWindowMinimized}">
        <!-- <div #smallWindow *ngFor="let selecteduseritem of selectedUsers,let i=index" (click)="activateSelectedWindow(i)" [class]="'flujoChat-box smallWindow '+ selecteduseritem.receiver_name "> -->
        <div class="chat-header" fxLayout="row">
          <div fxFlex class="user-name">
            <div class="dropdown d-inline-block">
              <a class="dropdown-toggle user-dropdown d-inline-block" data-toggle="dropdown">
                <span class="user-logo">
                  <img src="assets/team/kk.jpeg" class="img-fluid" alt="user logo">
                </span>
                {{selecteduseritem.receiver_name}}
                <!-- <p style="color:darkgreen; font-size: 10px" *ngIf="selecteduseritem.isTyping">Typing</p> -->
              </a>
            </div>
          </div>
          <div fxFlex="40" class="action-icons">
            <ul fxLayout="row" fxLayoutGap="20px">
              <li>
                <a href="#chat" class="fa fa-video-camera"></a>
              </li>
              <li>
                <a href="#chat" class="fa fa-phone"></a>
              </li>
              <li>
                <a href="#chat" class="fa fa-calendar-o"></a>
              </li>
              <li>
                <a href="#chat" class="fa fa-info-circle"></a>
              </li>
              <li>
                <a class="fa fa-times-circle-o" (click)="closeChatWindow(selecteduseritem, i)"></a>
              </li>
              <li (click)="minimizeWindow()">
                <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                  x="0px" y="0px" viewBox="0 0 485.6 485.6" style="width: 20px; margin-top: 8px; cursor: pointer;"
                  xml:space="preserve">
                  <g>
                    <path d="M0,455.7h358.5v-298H0V455.7z M63.4,221.1h231.5v171.1H63.4V221.1z M158.9,29.9h326.7v266.3h-63.5V93.4H158.9V29.9z" />
                  </g>
                </svg>
              </li>
            </ul>
          </div>

          <div class="smallWindow_actions">
            <div>
              <button (click)="hideChatWindow(selecteduseritem, i)">
                <svg *ngIf="selecteduseritem?.isChatWindowMinimized" viewBox="0 0 64 64" width="19px" height="24px">
                  <g>
                    <path fill="#1D1D1B" d="M3.352,48.296l28.56-28.328l28.58,28.347c0.397,0.394,0.917,0.59,1.436,0.59c0.52,0,1.04-0.196,1.436-0.59   c0.793-0.787,0.793-2.062,0-2.849l-29.98-29.735c-0.2-0.2-0.494-0.375-0.757-0.475c-0.75-0.282-1.597-0.107-2.166,0.456   L0.479,45.447c-0.793,0.787-0.793,2.062,0,2.849C1.273,49.082,2.558,49.082,3.352,48.296z" />
                  </g>
                </svg>
                <svg *ngIf="!selecteduseritem?.isChatWindowMinimized" class="cc-icons" viewBox="0 0 22 24" preserveAspectRatio="none" width="19px" height="24px">
                  <path d="M 5 11 L 5 13 L 19 13 L 19 11 Z "></path>
                </svg>
              </button>
              <button (click)="maximizeWindow()"><svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg"
                  xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512;"
                  xml:space="preserve">
                  <g>
                    <g>
                      <path d="M497,76H15C6.716,76,0,82.716,0,91v330c0,8.284,6.716,15,15,15h482c8.284,0,15-6.716,15-15V91
             C512,82.716,505.284,76,497,76z M482,406H30V106h452V406z" />
                    </g>
                  </g>
                </svg>
              </button>
              <button (click)="closeChatWindow(selecteduseritem, i)">
                <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                  x="0px" y="0px" viewBox="0 0 31.112 31.112" style="enable-background:new 0 0 31.112 31.112;"
                  xml:space="preserve">
                  <polygon points="31.112,1.414 29.698,0 15.556,14.142 1.414,0 0,1.414 14.142,15.556 0,29.698 1.414,31.112 15.556,16.97 
           29.698,31.112 31.112,29.698 16.97,15.556 " />
                </svg>
              </button>
            </div>
          </div>
        </div>

        <div #chatBody class="chat-body">
          <div #windowchathistory class="chatTexts_items" (scroll)="onScroll($event)">
            <div class="message-block msg-in">
              <div class="chat_scrollChat">
                <div #listHeight *ngFor="let chatItem of selecteduseritem.chat_history; let j = index" class="chat_text" [ngClass]="{'rightSideText':chatItem?.sender_id === loggedinUserObject.user_id}">
                  <!-- <span class="user-logo">
                    <img src="assets/team/yogesh.jpeg" class="img-fluid" alt="user logo">
                  </span> -->
                  <div>
                    <div class="message-data" *ngIf="chatItem.message_type == 'text'">
                      {{chatItem.message}}
                    </div>
                    <div *ngIf="chatItem.message_type =='image/png' || chatItem.message_type =='image/jpg' || chatItem.message_type =='image/gif'">
                      <img width="200" height='100' src='{{chatItem.message}}'>
                    </div>
                    <div class="message-status" *ngIf="chatItem?.sender_id === loggedinUserObject.user_id">
                      {{chatItem.created_time | date:'medium'}}
                      <label class="send-msg" *ngIf="chatItem?.status === -1"><span></span></label>
                      <label class="deliver-msg" *ngIf="chatItem?.status === 0"><span></span></label>
                      <label class="read_msg" *ngIf="chatItem?.status === 1">
                        <span></span>
                      </label>
                    </div>
                    <label class="message-time" *ngIf="chatItem?.sender_id !== loggedinUserObject.user_id">{{chatItem?.received_time
                      |
                      date:'medium'}}</label>
                  </div>
                  <div (click)="deleteMessage(i, j)">X</div>
                  <div *ngIf="chatItem.showMessageOptions">
                    <span (click)="deleteMessageConfirm(chatItem, 'flase', i)">Delete For Me</span> OR
                    <span (click)="deleteMessageConfirm(chatItem, 'true', i)">Delete For Every One</span>
                  </div>
                  <div (click)="updateMessage(chatItem, i)">U</div>
                </div>
                <div *ngIf="selecteduseritem.messageUpdateObject">
                  <input type="text" id={{selecteduseritem.sender_id}}>
                  <button (click)="updateMessageConfirm(i, true)">OK</button>
                  <button (click)="updateMessageConfirm(i, false)">CANCEL</button>
                </div>
              </div>
            </div>

            <!-- <div class="message-block msg-out">
              <div class="message-data">
                Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer
                took
                a
                galley of type
                and scrambled it to make a type specimen book.
              </div>
              <div>
                <span class="user-logo">
                  <img src="assets/team/kk.jpeg" class="img-fluid" alt="user logo">
                </span>
              </div>
            </div> -->

          </div>
          <div class="message-typing" *ngIf="selecteduseritem.isTyping">
            <p>{{selecteduseritem.receiver_name}}</p>
            <div class="loading_button">
              <span></span>
              <span></span>
              <span></span>
            </div>
          </div>
        </div>
        <div class="chat-input">
          <form [formGroup]="messageInputForm">
            <div class="inputMsg">
              <input *ngIf="selecteduseritem.isInputActivated" type="text" class="input-message" placeholder="Write Your Message..!"
                formControlName="message" (input)="onMessageInputListener($event.target.value, selecteduseritem, i)"
                (keyup.enter)="sendMessageToSelectedReceiver(selecteduseritem, i)">
            </div>
            <div class="chat_controls">
              <a (click)="addEmojiForSelectedWindow(i)">
                <i class="fa fa-smile-o"></i>
              </a>
              <input style="display:none" type="file" id="picked" #picked multiple="multiple" (change)="onFileUpload($event, selecteduseritem, i)">
              <i class="fa fa-paperclip" (click)="triggerUpload()"></i>
              <button class="send-button" type="submit" [disabled]="message?.length == 0" (click)="sendMessageToSelectedReceiver(selecteduseritem, i)">Send</button>
            </div>
            <div class="emojies_block" *ngIf="selecteduseritem.isEmojiWindowOpened">
              <emoji-mart (emojiClick)="addEmoji($event)"></emoji-mart>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>