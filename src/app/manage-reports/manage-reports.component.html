<!-- <h1> manage reports</h1>

    <div>
    <form class="example-form">
    <mat-form-field class="example-full-width">
      <input type="text" placeholder="Pick one" aria-label="Number" matInput [formControl]="myControl" [matAutocomplete]="auto">
      <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete">
        <mat-option (onSelectionChange)="callSomeFunction()" *ngFor="let option of filteredOptions | async" [value]="option">
          {{ option }}
        </mat-option>
      </mat-autocomplete>
    </mat-form-field>
  </form>
 </div> -->
<ngx-alerts maxMessages="3" timeout="5000"></ngx-alerts>
<ng4-loading-spinner></ng4-loading-spinner>

<div fxLayout="column" fxLayoutGap="15px">
  <div>
    <h6 class="issues">Issues</h6>
    <div fxLayoutAlign="center center">
      <app-headerurls></app-headerurls>
    </div>
  </div>
  <div fxLayout="row" fxLayoutGap="30px" fxLayoutAlign="end center">
    <div fxLayoutAlign="center center" class="group_btns" data-toggle="buttons">
      <button (click)="sortByStatus('0')" [ngClass]="{'active':showReports.completedActive}" name="options" id="option1" autocomplete="off"
        checked> Completed </button>
      <button (click)="sortByStatus('1')" [ngClass]="{'active':showReports.inProgressActive}" name="options" id="option2" autocomplete="off">
        In progress</button>
    </div>
    <div fxLayout="row" fxLayoutGap="10px" fxLayoutAlign="end center">
      <button (click)="exportManageReports()" class="btn btn-outline-secondary btn-sm btn-report pull-right">Export as CSV</button>
      <!-- <app-search-compoenent
    (searchTerm)="filterReportData($event)"
    ></app-search-compoenent> -->
      <mat-form-field>
        <input matInput placeholder="Search" [(ngModel)]="searchReport" (ngModelChange)="onChange($event)">
      </mat-form-field>
      <!-- <div class=" text-center button-group btn-group-toggle" data-toggle="buttons">
                <label class="pull-right btn btn-outline-secondary  btn-view-grid">
            <input type="radio"  name="options" id="view1" autocomplete="off" checked> <i class="fa fa-th"></i>
         </label>
                <label class="pull-right btn btn-outline-secondary  btn-view-list">
           <input type="radio"  name="options" id="view2" autocomplete="off"> <i class="fa fa-th-list"></i>
         </label>
            </div> -->
      <div class="dropdown">
        <ul class="pull-right btn btn-outline-secondary btn-issues dropdown-toggle" role="button" id="dropdownMenuLink" data-toggle="dropdown"
          aria-haspopup="true" aria-expanded="false">
          Filter By
          <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
            <!-- <mat-form-field>
              <mat-datepicker #picker></mat-datepicker>
              <input type="hidden" [matDatepicker]="picker" placeholder="Choose a date">
            </mat-form-field> -->
            <li class="dropdown-item" (click)="picker.open()">Date</li>
            <li class="dropdown-item">Issue</li>
          </div>
        </ul>
      </div>
    </div>
  </div>
  <br/>
  <div class="manage_reports_table" [perfectScrollbar]="config">
    <div class="manage_reports_data">
      <mat-card fxLayout="column">
        <div class="reports-header" fxFlex="100%" fxLayout="row" fxLayoutGap="2rem" fxLayoutAlign="start center">
          <div fxFlex="10.7%" class="name-field">
            <span fxFlex="100%" fxLayoutAlign="start center" class="fb-first-field">&nbsp;&nbsp;&nbsp;&nbsp;
              <input fxFlex="5%" class="d-inline" type="checkbox">
              <b>
                <p fxFlex="100%" class="d-inline" (click)="sortArray('name', 'name_arrow')">Name&nbsp;
                  <i *ngIf="!arrows.name_arrow" class="fa fa-angle-down d-inline"></i>
                  <i *ngIf="arrows.name_arrow" class="fa fa-angle-up d-inline"></i>
                </p>
              </b>
            </span>
          </div>
          <div fxFlex="11%" (click)="sortArray('submitted_at', 'submitted_at_arrow')">
            <span class="d-inline">Updated &nbsp;
              <i *ngIf="!arrows.submitted_at_arrow" class="fa fa-angle-down"></i>
              <i *ngIf="arrows.submitted_at_arrow" class="fa fa-angle-up"></i>
            </span>
          </div>
          <div fxFlex="11%">
            <span class="d-inline">Email </span>
          </div>
          <div fxFlex="11%">
            <span class="d-inline">Phone Number</span>
          </div>
          <div fxFlex="7%" (click)="sortArray('gender', 'gender_arrow')">
            <span class="d-inline">Gender&nbsp;
              <i *ngIf="!arrows.gender_arrow" class="fa fa-angle-down"></i>
              <i *ngIf="arrows.gender_arrow" class="fa fa-angle-up"></i>
            </span>
          </div>
          <div fxFlex="5%" (click)="sortArray('age', 'age_arrow')">
            <span class="d-inline">Age &nbsp;
              <i *ngIf="!arrows.age_arrow" class="fa fa-angle-down"></i>
              <i *ngIf="arrows.age_arrow" class="fa fa-angle-up"></i>
            </span>
          </div>
          <div fxFlex="30%" (click)="sortArray('area', 'area_arrow')">
            <span class="d-inline">Locality &nbsp;
              <i *ngIf="!arrows.area_arrow" class="fa fa-angle-down"></i>
              <i *ngIf="arrows.area_arrow" class="fa fa-angle-up"></i>
            </span>
          </div>
        </div>
        <mat-accordion>
          <mat-expansion-panel class="problem-box" *ngFor="let report of filterReportProblemData">
            <mat-expansion-panel-header>
              <div fxLayout="column" fxFlex="100%">
                <div class="reports-data" fxFlex="100%" fxLayout="row" fxLayoutGap="2rem" fxLayoutAlign="start center">
                  <div fxFlex="10.7%" class="name-data">
                    <span fxLayout="row" fxFlex="100%" fxLayoutAlign="start center" class="d-inline">
                      <p class="text-muted d-inline">
                        <i class="fa fa-ellipsis-v"></i>
                        <i class="fa fa-ellipsis-v"></i>
                      </p>
                      <input type="checkbox">
                      <b>
                        <p class="name-feedback d-inline">{{report.name}}</p>
                      </b>
                    </span>
                  </div>
                  <div fxFlex="12%">
                    <span fxFlex="100%" class="d-inline">{{report.submitted_at}}</span>
                  </div>
                  <div fxFlex="12%">
                    <span class="d-inline">{{report.email}}</span>
                  </div>
                  <div fxFlex="11%">
                    <span class="d-inline">{{report.phone}}</span>
                  </div>
                  <div fxFlex="7%">
                    <span class="d-inline">{{report.gender}} </span>
                  </div>
                  <div fxFlex="6%">
                    <span class="d-inline"> {{report.age}}</span>
                  </div>
                  <div fxFlex="30%">
                    <span class="d-inline">{{report.area}}</span>
                  </div>
                </div>
              </div>
            </mat-expansion-panel-header>
            <mat-action-row>
              <div fxLayout="column" fxFlex="100%">
                <div class="reports-data-ext problem-box" fxFlex="100%" fxLayout="row" fxLayoutGap="2rem" fxLayoutAlign="start center">
                  <div fxFlex="10.7%" class="report-problem-descr">
                    <span class="file-icon text-muted">
                      <i class="fa fa-paperclip"> </i>
                    </span>&nbsp;&nbsp;&nbsp;&nbsp;
                    <span class="d-inline report-file-descr">{{report.problem}}</span>
                  </div>
                  <div fxFlex="20%"></div>
                  <div fxFlex="11%">
                    <span class="text-muted d-inline">
                      Category:&nbsp;
                    </span>
                    <span class="d-inline">{{report.problem_type}}</span>
                  </div>
                  <div fxFlex="10%">
                    <span class="text-muted d-inline">
                      Source:&nbsp;
                    </span>
                    <span class="d-inline">{{report.source}}</span>
                  </div>

                  <div fxFlex="30%">
                    <span class="text-muted d-inline ">
                      Address:&nbsp;
                    </span>
                    <span class="d-inline address">
                      {{report.address}}
                    </span>
                  </div>
                </div>
              </div>
            </mat-action-row>
            <mat-action-row>
              <div fxLayout="column" fxFlex="100%">
                <div class="reports-data-form problem-box" fxFlex="100%" fxLayout="row" fxLayoutGap="2rem" fxLayoutAlign="start center">
                  <div class="assign-issue" fxLayout="row" fxLayoutAlign="start center" fxFlex="40%">
                    <div>
                      <span class="text-muted d-inline">Assign Issue:&nbsp;&nbsp;</span>
                    </div>
                    <div>
                      <form class="example-form d-inline form-inline">
                        <mat-form-field class="example-full-width">
                          <input type="text" placeholder="Pick one" aria-label="Number" matInput [formControl]="usersListControl" [matAutocomplete]="auto1">
                          <mat-autocomplete autoActiveFirstOption #auto1="matAutocomplete">
                            <mat-option *ngFor="let option of filteredusersListOptions | async" [value]="option" (click)="AssignedUserName(option, report.id)">
                              {{ option }}
                            </mat-option>
                          </mat-autocomplete>
                        </mat-form-field>
                        <button class="btn btn-outline-secondary btn-sm btn-report" (click)="updateAssignedUserIntoDB()">Assign</button>
                      </form>
                    </div>
                  </div>

                  <div fxLayout="row" fxFlex="25%" fxLayoutAlign="start center">
                    <div>
                      <span class="text-muted d-inline">Move To:&nbsp;&nbsp;</span>
                    </div>
                    <div>
                      <form class="example-form">
                        <mat-form-field class="example-full-width">
                          <input type="text" placeholder="Pick one" aria-label="Number" matInput [formControl]="moveToListControl" [matAutocomplete]="auto2">
                          <mat-autocomplete autoActiveFirstOption #auto2="matAutocomplete">
                            <mat-option *ngFor="let moveoption of filteredMoveToListOptions | async" [value]="moveoption" (click)="getMoveToOptions(moveoption)">
                              {{ moveoption }}
                            </mat-option>
                          </mat-autocomplete>
                        </mat-form-field>
                      </form>
                    </div>
                  </div>

                  <div class="assign-issue" fxFlex>
                    <form class="example-form form-inline">
                      <mat-form-field class="example-full-width">
                        <input type="text" placeholder="Remarks select or type" aria-label="Number" matInput [formControl]="remarksListControl" [matAutocomplete]="auto3">
                        <mat-autocomplete autoActiveFirstOption #auto3="matAutocomplete">
                          <mat-option *ngFor="let remarksoption of FilteredRemarksListOptions | async" [value]="remarksoption" (click)="getRemarksOption(remarksoption)">
                            {{ remarksoption }}
                          </mat-option>
                        </mat-autocomplete>
                      </mat-form-field>
                      <button class="btn btn-outline-secondary btn-sm btn-report" (click)="UpdateReportsStatus(report)">Assign</button>
                    </form>
                  </div>

                </div>
              </div>
            </mat-action-row>
          </mat-expansion-panel>
        </mat-accordion>
      </mat-card>
    </div>
  </div>
  <br/>
  <br/>
  <div class="feedback_footer" fxLayout="row" fxLayoutAlign="space-between ">
    <!-- <pagination-controls class="paginationn" (pageChange)="p = $event"></pagination-controls> -->
    <!--   <div class="sendMail-data">
              <form action="" [formGroup]="reportCsvMail" fxLayout="row" fxLayoutGap="15px">
                  <input class="form-control" formControlName="email" id="email" placeholder="Enter email">
                  <div [hidden]="reportCsvMail.controls.email.valid || (reportCsvMail.controls.email.pristine && !submitted)" class="form-error-msg">
                      enter valid email
                  </div>
                  <button (click)="reportCsvMailSubmit(reportCsvMail.value)" class="btn btn-outline-secondary btn-sm btn-report">Send As Email</button>
              </form>
          </div> -->
    <mat-paginator  *ngIf="filterReportProblemData" class="paginationn" #paginator
    [length]="filterReportProblemData.length"
    [pageIndex]="0"
    [pageSize]="5"
    [pageSizeOptions]="[5, 10, 25, 100]">
    </mat-paginator>
  </div>
</div>
